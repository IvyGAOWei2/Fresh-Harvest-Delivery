{% extends "_consumer-base.html" %}

{% block title %}Order History{% endblock %}

{% block navbar %}
    {% with is_order_history='1' %}
        {% include "components/layout/header/Nav1.html" %}
    {% endwith %}
{% endblock %}

{% block content %}
<style>
    .search-bar {
            border-radius: 25px;
            margin-bottom: 20px;
        }
    .btn-rounded {
        border-radius: 25px;
    }

  .gray-icon {
        color: gray !important;
    }

</style>

<section class="main-content">
    <div class="container-fluid py-5 mt-5">
        <div class="container py-5 text-center">
            <div class="account-header d-flex justify-content-center align-items-center py-4 mb-4">
                <i class="fas fa-history fa-3x me-3"></i> 
                <h1 class="mb-2">Order History</h1>
            </div>
            <form method="POST" action="/consumer/order/history">
                <div class="row mb-3 d-flex align-items-center">
                    <div class="col-md-4 d-flex align-items-center">
                        <label for="searchOrder" class="form-label me-3 pb-2">SEARCH</label>
                        <input type="number" class="form-control search-bar" id="searchOrder" placeholder="ORDER REFERENCE NUMBER">
                    </div>
                    <div class="col-md-3 d-flex align-items-center">
                        <label for="startDate" class="form-label me-3 pb-2">From</label>
                        <input type="date" class="form-control search-bar" id="fromDate">
                    </div>
                    <div class="col-md-3 d-flex align-items-center">
                        <label for="endDate" class="form-label me-3 pb-2">To</label>
                        <input type="date" class="form-control search-bar" id="toDate">
                    </div>
                    <div class="col-md-2 p-2">
                        <button class="btn btn-primary border-0 btn-rounded justify-content-end " style="top: 2; right: 0;" id="searchButton">Search</button>
                    </div>
                </div>
            </form>
        
            <div id="orders-table" class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Order Date</th>
                            <th>Delivery Date</th>
                            <th>Total Cost</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody class="table-group-divider">
                        {% for order in orders %}
                        <!-- Example Order Row -->
                        <tr>
                            <td>{{order.order_id}}</td>
                            <td>{{order.order_date}}</td>
                            <td>{{order.delivery_date}}</td>
                            <td>{{order.total}}</td>
                            <td>{{order.status}}</td>
                            <td>

                                <a href="{{ url_for('orderDetail') }}"   role="button"   class="btn order-view" role="button" title="Order Details">
                                    <i class="fas fa-eye fa-lg me-1"></i>
                                </a>
                                <a href="{{ url_for('cart') }}"  class="btn reorder" role="button" title="Empty Cart and Reorder">
                                    <i class="fas fa-cart-plus fa-lg me-1"></i>
                                </a>
                                {% if order.status == 'Pending' %}
                                    <a class="btn order-del" role="button" title="Cancel Order">
                                        <i class="fas fa-trash-alt fa-lg me-1" ></i>
                                    </a>
                                {% else %}
                                    <a class="btn order-del" href="#" role="button" title="Cancel Order">
                                        <i class="fas fa-trash-alt fa-lg me-1 gray-icon"></i>
                                    </a>
                                {% endif %}


                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>













    <!-- Update Success Message -->
    <div class="p-3">
        {% with
            btn_show = 0,
            btn_text = 'Profile Update Success',
            bg_color = '#81C408',
            title = 'Profile Update Success',
            msg = 'Your profile has been successfully updated'
        %}
            {% include "components/elements/updateSuccess.html" %}
        {% endwith %}
    </div>
</section>

{% endblock %}

{% block script %}
  {% include "components/elements/InputValidate.html" %}


 
  <script>


    let cancelOrderId = null;
    function setCancelOrderId(orderId) {
        cancelOrderId = orderId;
    }

    function confirmCancelOrder() {
        if (cancelOrderId) {
            // Perform the cancellation logic here
            alert('Order ' + cancelOrderId + ' has been canceled.');
            $('#cancelModal').modal('hide');
        }
    }

    function viewOrderDetails(orderId) {
        // Redirect to order details page or display order details
        alert('Viewing details for order ' + orderId);
    }
</script>

{% endblock %}


